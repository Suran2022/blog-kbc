# 博客项目数据库设计

## 一、数据库概述

本项目采用MySQL 8.x作为关系型数据库，用于存储博客系统的所有数据。数据库设计遵循第三范式（3NF）规范，确保数据的一致性和完整性。

## 二、数据库表设计

### 2.1 用户表(user)

用于存储系统用户（博主）信息。

```sql
CREATE TABLE `user` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '用户ID',
  `username` varchar(50) NOT NULL COMMENT '用户名',
  `password` varchar(100) NOT NULL COMMENT '密码（加密存储）',
  `nickname` varchar(50) NOT NULL COMMENT '昵称',
  `avatar` varchar(255) DEFAULT NULL COMMENT '头像URL',
  `email` varchar(100) DEFAULT NULL COMMENT '邮箱',
  `role` varchar(20) NOT NULL DEFAULT 'admin' COMMENT '角色',
  `create_time` datetime NOT NULL COMMENT '创建时间',
  `update_time` datetime NOT NULL COMMENT '更新时间',
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_username` (`username`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci COMMENT='用户表';
```

### 2.2 文章表(article)

用于存储博客文章信息。

```sql
CREATE TABLE `article` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '文章ID',
  `title` varchar(100) NOT NULL COMMENT '文章标题',
  `content` longtext NOT NULL COMMENT '文章内容',
  `summary` varchar(255) DEFAULT NULL COMMENT '文章摘要',
  `category_id` bigint DEFAULT NULL COMMENT '分类ID',
  `view_count` int DEFAULT '0' COMMENT '浏览次数',
  `create_time` datetime NOT NULL COMMENT '创建时间',
  `update_time` datetime NOT NULL COMMENT '更新时间',
  `status` tinyint NOT NULL DEFAULT '1' COMMENT '状态（0草稿，1已发布）',
  `cover_image` varchar(255) DEFAULT NULL COMMENT '封面图片URL',
  PRIMARY KEY (`id`),
  KEY `idx_category_id` (`category_id`),
  KEY `idx_create_time` (`create_time`),
  CONSTRAINT `fk_article_category` FOREIGN KEY (`category_id`) REFERENCES `category` (`id`) ON DELETE SET NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci COMMENT='文章表';
```

### 2.3 分类表(category)

用于存储文章分类信息。

```sql
CREATE TABLE `category` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '分类ID',
  `name` varchar(50) NOT NULL COMMENT '分类名称',
  `description` varchar(255) DEFAULT NULL COMMENT '分类描述',
  `create_time` datetime NOT NULL COMMENT '创建时间',
  `update_time` datetime NOT NULL COMMENT '更新时间',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci COMMENT='分类表';
```

### 2.4 系统设置表(setting)

用于存储博客系统的全局设置。

```sql
CREATE TABLE `setting` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '设置ID',
  `site_name` varchar(50) NOT NULL COMMENT '站点名称',
  `logo_url` varchar(255) DEFAULT NULL COMMENT 'Logo图片URL',
  `description` varchar(255) DEFAULT NULL COMMENT '站点描述',
  `keywords` varchar(255) DEFAULT NULL COMMENT '站点关键词',
  `footer_info` varchar(255) DEFAULT NULL COMMENT '页脚信息',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci COMMENT='系统设置表';
```

### 2.5 贡献者表(contributor)

用于存储博客贡献者信息。

```sql
CREATE TABLE `contributor` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '贡献者ID',
  `name` varchar(50) NOT NULL COMMENT '贡献者名称',
  `description` varchar(255) DEFAULT NULL COMMENT '贡献描述',
  `link` varchar(255) DEFAULT NULL COMMENT '相关链接',
  `create_time` datetime NOT NULL COMMENT '创建时间',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci COMMENT='贡献者表';
```

## 三、表关系说明

### 3.1 实体关系图(ER图)

```
+-------------+       +-------------+       +-------------+
|    User     |       |   Article   |       |  Category   |
+-------------+       +-------------+       +-------------+
| id          |       | id          |       | id          |
| username    |       | title       |       | name        |
| password    |       | content     |       | description |
| nickname    |       | summary     |<------| create_time |
| avatar      |       | category_id |       | update_time |
| email       |       | view_count  |       +-------------+
| role        |       | create_time |              
| create_time |       | update_time |              
| update_time |       | status      |              
+-------------+       | cover_image |              
                      +-------------+              
                                                  
+-------------+                        +-------------+
|   Setting   |                        | Contributor |
+-------------+                        +-------------+
| id          |                        | id          |
| site_name   |                        | name        |
| logo_url    |                        | description |
| description |                        | link        |
| keywords    |                        | create_time |
| footer_info |                        +-------------+
+-------------+
```

### 3.2 关系说明

1. **文章与分类**：一对多关系
   - 一个分类可以包含多篇文章
   - 一篇文章只能属于一个分类
   - 外键：`article.category_id` 引用 `category.id`
   - 级联操作：当删除分类时，相关文章的分类ID设为NULL

2. **用户与文章**：隐性一对多关系
   - 由于本系统只有博主一个用户角色，因此未在文章表中设置用户ID外键
   - 所有文章默认由博主创建和管理

3. **系统设置**：独立实体
   - 存储全局配置信息，与其他实体无直接关联

4. **贡献者**：独立实体
   - 存储贡献者信息，与其他实体无直接关联

## 四、索引设计

### 4.1 主键索引

每个表都有自增的`id`字段作为主键索引，用于唯一标识记录。

### 4.2 唯一索引

- `user`表的`username`字段设置唯一索引，确保用户名不重复

### 4.3 普通索引

- `article`表的`category_id`字段，用于加速分类查询
- `article`表的`create_time`字段，用于加速时间排序查询

## 五、数据字典

### 5.1 用户表(user)

| 字段名 | 数据类型 | 允许为空 | 默认值 | 说明 |
| --- | --- | --- | --- | --- |
| id | bigint | 否 | 自增 | 用户ID |
| username | varchar(50) | 否 | 无 | 用户名 |
| password | varchar(100) | 否 | 无 | 密码（加密存储） |
| nickname | varchar(50) | 否 | 无 | 昵称 |
| avatar | varchar(255) | 是 | NULL | 头像URL |
| email | varchar(100) | 是 | NULL | 邮箱 |
| role | varchar(20) | 否 | 'admin' | 角色 |
| create_time | datetime | 否 | 无 | 创建时间 |
| update_time | datetime | 否 | 无 | 更新时间 |

### 5.2 文章表(article)

| 字段名 | 数据类型 | 允许为空 | 默认值 | 说明 |
| --- | --- | --- | --- | --- |
| id | bigint | 否 | 自增 | 文章ID |
| title | varchar(100) | 否 | 无 | 文章标题 |
| content | longtext | 否 | 无 | 文章内容 |
| summary | varchar(255) | 是 | NULL | 文章摘要 |
| category_id | bigint | 是 | NULL | 分类ID |
| view_count | int | 是 | 0 | 浏览次数 |
| create_time | datetime | 否 | 无 | 创建时间 |
| update_time | datetime | 否 | 无 | 更新时间 |
| status | tinyint | 否 | 1 | 状态（0草稿，1已发布） |
| cover_image | varchar(255) | 是 | NULL | 封面图片URL |

### 5.3 分类表(category)

| 字段名 | 数据类型 | 允许为空 | 默认值 | 说明 |
| --- | --- | --- | --- | --- |
| id | bigint | 否 | 自增 | 分类ID |
| name | varchar(50) | 否 | 无 | 分类名称 |
| description | varchar(255) | 是 | NULL | 分类描述 |
| create_time | datetime | 否 | 无 | 创建时间 |
| update_time | datetime | 否 | 无 | 更新时间 |

### 5.4 系统设置表(setting)

| 字段名 | 数据类型 | 允许为空 | 默认值 | 说明 |
| --- | --- | --- | --- | --- |
| id | bigint | 否 | 自增 | 设置ID |
| site_name | varchar(50) | 否 | 无 | 站点名称 |
| logo_url | varchar(255) | 是 | NULL | Logo图片URL |
| description | varchar(255) | 是 | NULL | 站点描述 |
| keywords | varchar(255) | 是 | NULL | 站点关键词 |
| footer_info | varchar(255) | 是 | NULL | 页脚信息 |

### 5.5 贡献者表(contributor)

| 字段名 | 数据类型 | 允许为空 | 默认值 | 说明 |
| --- | --- | --- | --- | --- |
| id | bigint | 否 | 自增 | 贡献者ID |
| name | varchar(50) | 否 | 无 | 贡献者名称 |
| description | varchar(255) | 是 | NULL | 贡献描述 |
| link | varchar(255) | 是 | NULL | 相关链接 |
| create_time | datetime | 否 | 无 | 创建时间 |

## 六、初始化数据

### 6.1 用户表初始数据

```sql
INSERT INTO `user` (`username`, `password`, `nickname`, `role`, `create_time`, `update_time`) 
VALUES ('admin', '$2a$10$xVNrXDXGI1xYHv5PQCQ8AOuQvBSjO8VZbj8UbIVfzGKIbZ8uZ5bHa', '管理员', 'admin', NOW(), NOW());
```
注：密码为加密后的字符串，原始密码为'admin123'。

### 6.2 分类表初始数据

```sql
INSERT INTO `category` (`name`, `description`, `create_time`, `update_time`) VALUES
('技术', '技术相关文章', NOW(), NOW()),
('生活', '生活随笔', NOW(), NOW()),
('资讯', '行业资讯', NOW(), NOW());
```

### 6.3 系统设置表初始数据

```sql
INSERT INTO `setting` (`site_name`, `description`, `keywords`, `footer_info`) 
VALUES ('我的博客', '一个简洁的博客系统', '博客,技术,生活', '© 2023 我的博客 版权所有');
```

## 七、数据库维护建议

### 7.1 备份策略

- 每日进行全量备份
- 保留最近7天的备份
- 每月进行一次归档备份并长期保存

### 7.2 性能优化

- 定期分析表结构和查询性能
- 根据实际使用情况调整索引
- 对大表进行分区或分表处理（如文章表数据量大时）

### 7.3 安全措施

- 限制数据库远程访问
- 定期更改数据库密码
- 设置合理的用户权限
- 对敏感数据进行加密存储